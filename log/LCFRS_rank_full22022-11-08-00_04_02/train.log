2022-11-08 00:04:07,130 - INFO - {'device': 'cuda', 'save_dir': 'log/lcfrs_tiger5/LCFRS_rank_full22022-11-08-00_04_02', 'data': {'train_file': 'data/train_nopunct_negra_tiger.pickle', 'val_file': 'data/negra_nopunct_test.pickle', 'test_file': 'data/tiger_nopunct_test.pickle', 'use_cache': 0, 'cache': 0, 'vocab_cache': 'data/ptb-vocab.pickle', 'train_dataset_cache': 'data/train_nopunct_tiger.cache.epickle', 'val_dataset_cache': 'data/dev_nopunct_cache_tiger.pickle', 'test_dataset_cache': 'data/test_nopunct_cache_tiger.pickle', 'vocab_type': 'max_size', 'vocab_size': 10000, 'min_freq': 2, 'use_emb': False, 'emb_path': 'data/cc.de.300.filter.vec', 'word_emb_size': 300, 'use_char': False}, 'model': {'model_name': 'LCFRS_rank_full2', 'activation': 'relu', 'NT': 1500, 'T': 4500, 'D': 1500, 'r1': 400, 'r2': 4, 'r3': 400, 'r4': 4, 'layer': 3, 's_dim': 512, 'w_dim': 512, 'h_dim': 512, 'z_dim': 64, 'use_char': False, 'use_split': False, 'share_r': True, 'share_pt': True, 'sep_emb': False, 'merge': False, 'share_dd': False, 'share_d': False, 'ban_nested': False, 'init': 'xn', 'init_vocab': 'xn', 'type': 4, 'use_activation': True}, 'train': {'batch_size': 20, 'max_epoch': 30, 'max_len': 40, 'curriculum': 1, 'start_len': 25, 'increment': 5, 'patience': 10, 'clip': 3, 'em': False, 'em_epoch': 1, 'st': False, 'eval_test': True}, 'test': {'batch_size': 16, 'max_tokens': 100, 'bucket': 32, 'decode': 'mbr', 'sampler': 'batch'}, 'optimizer': {'name': 'adam', 'lr': 0.002, 'mu': 0.75, 'nu': 0.999}, 'conf': 'config/lcfrs_tiger5.yaml'}
2022-11-08 00:04:07,131 - INFO - Create the model
2022-11-08 00:04:07,132 - INFO - NeuralLCFRS_rankspace_full2(
  (activate): ReLU()
  (term_mlp): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): ResLayer(
      (linear): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
        (1): ReLU()
        (2): Linear(in_features=512, out_features=512, bias=True)
        (3): ReLU()
      )
    )
    (2): ResLayer(
      (linear): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
        (1): ReLU()
        (2): Linear(in_features=512, out_features=512, bias=True)
        (3): ReLU()
      )
    )
    (3): ResLayer(
      (linear): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
        (1): ReLU()
        (2): Linear(in_features=512, out_features=512, bias=True)
        (3): ReLU()
      )
    )
  )
  (root_mlp): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): ResLayer(
      (linear): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
        (1): ReLU()
        (2): Linear(in_features=512, out_features=512, bias=True)
        (3): ReLU()
      )
    )
    (2): ResLayer(
      (linear): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
        (1): ReLU()
        (2): Linear(in_features=512, out_features=512, bias=True)
        (3): ReLU()
      )
    )
    (3): Linear(in_features=512, out_features=1500, bias=True)
  )
  (decision): Sequential(
    (0): ResLayer(
      (linear): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
        (1): ReLU()
        (2): Linear(in_features=512, out_features=512, bias=True)
        (3): ReLU()
      )
    )
    (1): Linear(in_features=512, out_features=4, bias=True)
  )
  (left_c): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): ReLU()
  )
  (left_d): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): ReLU()
  )
  (right_c): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): ReLU()
  )
  (right_d): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): ReLU()
  )
  (parent_c): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): ReLU()
  )
  (parent_d): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): ReLU()
  )
  (cd_mlp): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): ReLU()
  )
  (cc_mlp): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): ReLU()
  )
)

2022-11-08 00:04:07,132 - INFO - Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.75, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    lr: 0.002
    maximize: False
    weight_decay: 0
)
2022-11-08 00:04:07,132 - INFO - {'device': 'cuda', 'save_dir': 'log/lcfrs_tiger5/LCFRS_rank_full22022-11-08-00_04_02', 'data': {'train_file': 'data/train_nopunct_negra_tiger.pickle', 'val_file': 'data/negra_nopunct_test.pickle', 'test_file': 'data/tiger_nopunct_test.pickle', 'use_cache': 0, 'cache': 0, 'vocab_cache': 'data/ptb-vocab.pickle', 'train_dataset_cache': 'data/train_nopunct_tiger.cache.epickle', 'val_dataset_cache': 'data/dev_nopunct_cache_tiger.pickle', 'test_dataset_cache': 'data/test_nopunct_cache_tiger.pickle', 'vocab_type': 'max_size', 'vocab_size': 10000, 'min_freq': 2, 'use_emb': False, 'emb_path': 'data/cc.de.300.filter.vec', 'word_emb_size': 300, 'use_char': False}, 'model': {'model_name': 'LCFRS_rank_full2', 'activation': 'relu', 'NT': 1500, 'T': 4500, 'D': 1500, 'r1': 400, 'r2': 4, 'r3': 400, 'r4': 4, 'layer': 3, 's_dim': 512, 'w_dim': 512, 'h_dim': 512, 'z_dim': 64, 'use_char': False, 'use_split': False, 'share_r': True, 'share_pt': True, 'sep_emb': False, 'merge': False, 'share_dd': False, 'share_d': False, 'ban_nested': False, 'init': 'xn', 'init_vocab': 'xn', 'type': 4, 'use_activation': True}, 'train': {'batch_size': 20, 'max_epoch': 30, 'max_len': 40, 'curriculum': 1, 'start_len': 25, 'increment': 5, 'patience': 10, 'clip': 3, 'em': False, 'em_epoch': 1, 'st': False, 'eval_test': True}, 'test': {'batch_size': 16, 'max_tokens': 100, 'bucket': 32, 'decode': 'mbr', 'sampler': 'batch'}, 'optimizer': {'name': 'adam', 'lr': 0.002, 'mu': 0.75, 'nu': 0.999}, 'conf': 'config/lcfrs_tiger5.yaml'}
2022-11-08 00:11:58,960 - INFO - Epoch 1 / 30:
2022-11-08 00:12:10,656 - INFO - dev f1:   F1:40.35% Co F1: 44.36%, Disco F1:  5.60%, Co P: 33.29%, Co R:66.48%,  Disco P: 3.58%, Disco R:12.88%,   Cont TP: 3493.0, Cont FP: 7001.0, Cont FN: 1761.0, Disco TP: 51.0, Disco FP: 1373.0, Disco FN: 345.0
2022-11-08 00:12:10,657 - INFO - dev ll:   avg likelihood: -86.31804656982422, perp. :216.33799743652344
2022-11-08 00:13:09,076 - INFO - test f1:   F1:38.96% Co F1: 42.67%, Disco F1:  4.59%, Co P: 32.34%, Co R:62.72%,  Disco P: 2.85%, Disco R:11.86%,   Cont TP: 18199.0, Cont FP: 38078.0, Cont FN: 10819.0, Disco TP: 212.0, Disco FP: 7229.0, Disco FN: 1575.0
2022-11-08 00:13:09,076 - INFO - test ll:   avg likelihood: -87.5849609375, perp. :205.94802856445312
2022-11-08 00:13:09,337 - INFO - 0:09:01.134652s elapsed, Best saved

2022-11-08 00:22:41,309 - INFO - Epoch 2 / 30:
2022-11-08 00:22:52,931 - INFO - dev f1:   F1:44.47% Co F1: 48.73%, Disco F1:  6.33%, Co P: 36.51%, Co R:73.28%,  Disco P: 4.08%, Disco R:14.14%,   Cont TP: 3850.0, Cont FP: 6696.0, Cont FN: 1404.0, Disco TP: 56.0, Disco FP: 1316.0, Disco FN: 340.0
2022-11-08 00:22:52,932 - INFO - dev ll:   avg likelihood: -82.67268371582031, perp. :172.3915557861328
2022-11-08 00:23:51,051 - INFO - test f1:   F1:43.30% Co F1: 47.27%, Disco F1:  5.24%, Co P: 35.72%, Co R:69.86%,  Disco P: 3.28%, Disco R:13.09%,   Cont TP: 20209.0, Cont FP: 36368.0, Cont FN: 8719.0, Disco TP: 234.0, Disco FP: 6907.0, Disco FN: 1553.0
2022-11-08 00:23:51,051 - INFO - test ll:   avg likelihood: -84.1450424194336, perp. :167.06451416015625
2022-11-08 00:23:51,299 - INFO - 0:10:40.403841s elapsed, Best saved

2022-11-08 00:34:36,415 - INFO - Epoch 3 / 30:
2022-11-08 00:34:48,078 - INFO - dev f1:   F1:46.23% Co F1: 50.48%, Disco F1:  6.69%, Co P: 37.74%, Co R:76.21%,  Disco P: 4.35%, Disco R:14.39%,   Cont TP: 4004.0, Cont FP: 6605.0, Cont FN: 1250.0, Disco TP: 57.0, Disco FP: 1252.0, Disco FN: 339.0
2022-11-08 00:34:48,079 - INFO - dev ll:   avg likelihood: -81.12496185302734, perp. :156.54742431640625
2022-11-08 00:35:46,341 - INFO - test f1:   F1:44.57% Co F1: 48.54%, Disco F1:  5.47%, Co P: 36.63%, Co R:71.94%,  Disco P: 3.44%, Disco R:13.32%,   Cont TP: 20803.0, Cont FP: 35993.0, Cont FN: 8114.0, Disco TP: 238.0, Disco FP: 6684.0, Disco FN: 1549.0
2022-11-08 00:35:46,342 - INFO - test ll:   avg likelihood: -82.69055938720703, perp. :152.91867065429688
2022-11-08 00:35:46,589 - INFO - 0:11:53.766805s elapsed, Best saved

2022-11-08 00:47:32,819 - INFO - Epoch 4 / 30:
2022-11-08 00:47:44,489 - INFO - dev f1:   F1:46.40% Co F1: 50.50%, Disco F1:  7.12%, Co P: 37.70%, Co R:76.46%,  Disco P: 4.68%, Disco R:14.90%,   Cont TP: 4017.0, Cont FP: 6639.0, Cont FN: 1237.0, Disco TP: 59.0, Disco FP: 1203.0, Disco FN: 337.0
2022-11-08 00:47:44,489 - INFO - dev ll:   avg likelihood: -80.39993286132812, perp. :149.6345977783203
2022-11-08 00:48:42,787 - INFO - test f1:   F1:45.24% Co F1: 49.12%, Disco F1:  5.69%, Co P: 37.01%, Co R:73.03%,  Disco P: 3.61%, Disco R:13.43%,   Cont TP: 21118.0, Cont FP: 35949.0, Cont FN: 7797.0, Disco TP: 240.0, Disco FP: 6411.0, Disco FN: 1547.0
2022-11-08 00:48:42,787 - INFO - test ll:   avg likelihood: -82.0417251586914, perp. :147.0009307861328
2022-11-08 00:48:43,080 - INFO - 0:12:54.926794s elapsed, Best saved

2022-11-08 01:01:10,853 - INFO - Epoch 5 / 30:
2022-11-08 01:01:22,585 - INFO - dev f1:   F1:46.51% Co F1: 50.59%, Disco F1:  6.83%, Co P: 37.75%, Co R:76.68%,  Disco P: 4.50%, Disco R:14.14%,   Cont TP: 4029.0, Cont FP: 6644.0, Cont FN: 1225.0, Disco TP: 56.0, Disco FP: 1189.0, Disco FN: 340.0
2022-11-08 01:01:22,586 - INFO - dev ll:   avg likelihood: -80.08074951171875, perp. :146.6889190673828
2022-11-08 01:02:21,478 - INFO - test f1:   F1:45.19% Co F1: 49.07%, Disco F1:  5.51%, Co P: 36.96%, Co R:72.99%,  Disco P: 3.50%, Disco R:12.98%,   Cont TP: 21103.0, Cont FP: 35988.0, Cont FN: 7811.0, Disco TP: 232.0, Disco FP: 6395.0, Disco FN: 1555.0
2022-11-08 01:02:21,478 - INFO - test ll:   avg likelihood: -81.7509994506836, perp. :144.42422485351562
2022-11-08 01:02:21,478 - INFO - 0:13:37.138063s elapsed

2022-11-08 01:14:47,963 - INFO - Epoch 6 / 30:
2022-11-08 01:14:59,736 - INFO - dev f1:   F1:47.36% Co F1: 51.56%, Disco F1:  6.48%, Co P: 38.47%, Co R:78.17%,  Disco P: 4.27%, Disco R:13.38%,   Cont TP: 4107.0, Cont FP: 6570.0, Cont FN: 1147.0, Disco TP: 53.0, Disco FP: 1188.0, Disco FN: 343.0
2022-11-08 01:14:59,736 - INFO - dev ll:   avg likelihood: -79.83247375488281, perp. :144.4377899169922
2022-11-08 01:15:58,312 - INFO - test f1:   F1:46.09% Co F1: 50.12%, Disco F1:  5.47%, Co P: 37.77%, Co R:74.46%,  Disco P: 3.46%, Disco R:13.04%,   Cont TP: 21524.0, Cont FP: 35465.0, Cont FN: 7384.0, Disco TP: 233.0, Disco FP: 6496.0, Disco FN: 1554.0
2022-11-08 01:15:58,313 - INFO - test ll:   avg likelihood: -81.48859405517578, perp. :142.13726806640625
2022-11-08 01:15:58,313 - INFO - 0:13:35.622670s elapsed

2022-11-08 01:28:28,242 - INFO - Epoch 7 / 30:
2022-11-08 01:28:40,068 - INFO - dev f1:   F1:46.85% Co F1: 50.85%, Disco F1:  6.88%, Co P: 37.89%, Co R:77.27%,  Disco P: 4.57%, Disco R:13.89%,   Cont TP: 4060.0, Cont FP: 6655.0, Cont FN: 1194.0, Disco TP: 55.0, Disco FP: 1148.0, Disco FN: 341.0
2022-11-08 01:28:40,068 - INFO - dev ll:   avg likelihood: -79.34674835205078, perp. :140.13308715820312
2022-11-08 01:29:38,745 - INFO - test f1:   F1:45.81% Co F1: 49.61%, Disco F1:  5.65%, Co P: 37.32%, Co R:73.99%,  Disco P: 3.61%, Disco R:12.93%,   Cont TP: 21394.0, Cont FP: 35933.0, Cont FN: 7522.0, Disco TP: 231.0, Disco FP: 6160.0, Disco FN: 1556.0
2022-11-08 01:29:38,745 - INFO - test ll:   avg likelihood: -81.05077362060547, perp. :138.40185546875
2022-11-08 01:29:38,745 - INFO - 0:13:39.109991s elapsed

2022-11-08 01:42:09,989 - INFO - Epoch 8 / 30:
2022-11-08 01:42:21,867 - INFO - dev f1:   F1:46.61% Co F1: 50.48%, Disco F1:  7.25%, Co P: 37.58%, Co R:76.84%,  Disco P: 4.84%, Disco R:14.39%,   Cont TP: 4037.0, Cont FP: 6704.0, Cont FN: 1217.0, Disco TP: 57.0, Disco FP: 1120.0, Disco FN: 339.0
2022-11-08 01:42:21,867 - INFO - dev ll:   avg likelihood: -79.23298645019531, perp. :139.1435089111328
2022-11-08 01:43:20,786 - INFO - test f1:   F1:45.62% Co F1: 49.38%, Disco F1:  5.33%, Co P: 37.12%, Co R:73.74%,  Disco P: 3.43%, Disco R:12.03%,   Cont TP: 21324.0, Cont FP: 36119.0, Cont FN: 7593.0, Disco TP: 215.0, Disco FP: 6060.0, Disco FN: 1572.0
2022-11-08 01:43:20,787 - INFO - test ll:   avg likelihood: -81.10983276367188, perp. :138.89996337890625
2022-11-08 01:43:21,059 - INFO - 0:13:40.752279s elapsed, Best saved

2022-11-08 01:55:46,468 - INFO - Epoch 9 / 30:
2022-11-08 01:55:58,349 - INFO - dev f1:   F1:46.80% Co F1: 50.74%, Disco F1:  6.95%, Co P: 37.79%, Co R:77.20%,  Disco P: 4.64%, Disco R:13.89%,   Cont TP: 4056.0, Cont FP: 6676.0, Cont FN: 1198.0, Disco TP: 55.0, Disco FP: 1131.0, Disco FN: 341.0
2022-11-08 01:55:58,350 - INFO - dev ll:   avg likelihood: -79.0499038696289, perp. :137.56573486328125
2022-11-08 01:56:57,487 - INFO - test f1:   F1:45.83% Co F1: 49.61%, Disco F1:  5.49%, Co P: 37.29%, Co R:74.07%,  Disco P: 3.52%, Disco R:12.42%,   Cont TP: 21413.0, Cont FP: 36007.0, Cont FN: 7497.0, Disco TP: 222.0, Disco FP: 6076.0, Disco FN: 1565.0
2022-11-08 01:56:57,487 - INFO - test ll:   avg likelihood: -80.98153686523438, perp. :137.82022094726562
2022-11-08 01:56:57,487 - INFO - 0:13:35.129428s elapsed

2022-11-08 02:09:23,490 - INFO - Epoch 10 / 30:
2022-11-08 02:09:35,455 - INFO - dev f1:   F1:46.80% Co F1: 50.79%, Disco F1:  6.78%, Co P: 37.84%, Co R:77.22%,  Disco P: 4.51%, Disco R:13.64%,   Cont TP: 4057.0, Cont FP: 6664.0, Cont FN: 1197.0, Disco TP: 54.0, Disco FP: 1143.0, Disco FN: 342.0
2022-11-08 02:09:35,455 - INFO - dev ll:   avg likelihood: -79.31624603271484, perp. :139.8670654296875
2022-11-08 02:10:35,278 - INFO - test f1:   F1:45.80% Co F1: 49.57%, Disco F1:  5.45%, Co P: 37.26%, Co R:74.01%,  Disco P: 3.50%, Disco R:12.31%,   Cont TP: 21402.0, Cont FP: 36036.0, Cont FN: 7516.0, Disco TP: 220.0, Disco FP: 6060.0, Disco FN: 1567.0
2022-11-08 02:10:35,278 - INFO - test ll:   avg likelihood: -81.0906753540039, perp. :138.73825073242188
2022-11-08 02:10:35,278 - INFO - 0:13:36.538784s elapsed

2022-11-08 02:23:01,150 - INFO - Epoch 11 / 30:
2022-11-08 02:23:13,082 - INFO - dev f1:   F1:47.04% Co F1: 51.04%, Disco F1:  7.01%, Co P: 38.03%, Co R:77.58%,  Disco P: 4.66%, Disco R:14.14%,   Cont TP: 4076.0, Cont FP: 6641.0, Cont FN: 1178.0, Disco TP: 56.0, Disco FP: 1145.0, Disco FN: 340.0
2022-11-08 02:23:13,082 - INFO - dev ll:   avg likelihood: -79.5943832397461, perp. :142.31149291992188
2022-11-08 02:24:12,346 - INFO - test f1:   F1:45.66% Co F1: 49.41%, Disco F1:  5.60%, Co P: 37.13%, Co R:73.81%,  Disco P: 3.60%, Disco R:12.65%,   Cont TP: 21325.0, Cont FP: 36109.0, Cont FN: 7568.0, Disco TP: 226.0, Disco FP: 6058.0, Disco FN: 1561.0
2022-11-08 02:24:12,347 - INFO - test ll:   avg likelihood: -81.44757080078125, perp. :141.78305053710938
2022-11-08 02:24:12,347 - INFO - 0:13:35.822987s elapsed

2022-11-08 02:36:36,070 - INFO - Epoch 12 / 30:
2022-11-08 02:36:47,987 - INFO - dev f1:   F1:46.58% Co F1: 50.47%, Disco F1:  7.54%, Co P: 37.60%, Co R:76.74%,  Disco P: 5.02%, Disco R:15.15%,   Cont TP: 4032.0, Cont FP: 6691.0, Cont FN: 1222.0, Disco TP: 60.0, Disco FP: 1135.0, Disco FN: 336.0
2022-11-08 02:36:47,988 - INFO - dev ll:   avg likelihood: -79.20062255859375, perp. :138.86334228515625
2022-11-08 02:37:47,195 - INFO - test f1:   F1:45.72% Co F1: 49.51%, Disco F1:  5.67%, Co P: 37.23%, Co R:73.86%,  Disco P: 3.63%, Disco R:12.93%,   Cont TP: 21354.0, Cont FP: 35997.0, Cont FN: 7557.0, Disco TP: 231.0, Disco FP: 6136.0, Disco FN: 1556.0
2022-11-08 02:37:47,196 - INFO - test ll:   avg likelihood: -81.08401489257812, perp. :138.6819610595703
2022-11-08 02:37:47,425 - INFO - 0:13:33.594326s elapsed, Best saved

2022-11-08 02:50:11,625 - INFO - Epoch 13 / 30:
2022-11-08 02:50:23,503 - INFO - dev f1:   F1:47.06% Co F1: 50.98%, Disco F1:  7.46%, Co P: 37.97%, Co R:77.56%,  Disco P: 4.98%, Disco R:14.90%,   Cont TP: 4075.0, Cont FP: 6658.0, Cont FN: 1179.0, Disco TP: 59.0, Disco FP: 1126.0, Disco FN: 337.0
2022-11-08 02:50:23,503 - INFO - dev ll:   avg likelihood: -79.26721954345703, perp. :139.44061279296875
2022-11-08 02:51:22,672 - INFO - test f1:   F1:46.01% Co F1: 49.78%, Disco F1:  5.77%, Co P: 37.42%, Co R:74.32%,  Disco P: 3.70%, Disco R:13.04%,   Cont TP: 21490.0, Cont FP: 35933.0, Cont FN: 7425.0, Disco TP: 233.0, Disco FP: 6062.0, Disco FN: 1554.0
2022-11-08 02:51:22,672 - INFO - test ll:   avg likelihood: -81.03961181640625, perp. :138.3079833984375
2022-11-08 02:51:22,673 - INFO - 0:13:33.964614s elapsed

2022-11-08 03:03:47,258 - INFO - Epoch 14 / 30:
2022-11-08 03:03:59,202 - INFO - dev f1:   F1:46.61% Co F1: 50.46%, Disco F1:  7.49%, Co P: 37.58%, Co R:76.80%,  Disco P: 5.00%, Disco R:14.90%,   Cont TP: 4035.0, Cont FP: 6703.0, Cont FN: 1219.0, Disco TP: 59.0, Disco FP: 1121.0, Disco FN: 337.0
2022-11-08 03:03:59,203 - INFO - dev ll:   avg likelihood: -79.2744140625, perp. :139.50311279296875
2022-11-08 03:04:58,513 - INFO - test f1:   F1:45.88% Co F1: 49.65%, Disco F1:  5.80%, Co P: 37.32%, Co R:74.14%,  Disco P: 3.72%, Disco R:13.15%,   Cont TP: 21420.0, Cont FP: 35978.0, Cont FN: 7470.0, Disco TP: 235.0, Disco FP: 6085.0, Disco FN: 1552.0
2022-11-08 03:04:58,513 - INFO - test ll:   avg likelihood: -81.01779174804688, perp. :138.12449645996094
2022-11-08 03:04:58,513 - INFO - 0:13:34.584640s elapsed

2022-11-08 03:17:25,343 - INFO - Epoch 15 / 30:
2022-11-08 03:17:37,297 - INFO - dev f1:   F1:46.85% Co F1: 50.75%, Disco F1:  7.01%, Co P: 37.79%, Co R:77.27%,  Disco P: 4.69%, Disco R:13.89%,   Cont TP: 4060.0, Cont FP: 6685.0, Cont FN: 1194.0, Disco TP: 55.0, Disco FP: 1118.0, Disco FN: 341.0
2022-11-08 03:17:37,297 - INFO - dev ll:   avg likelihood: -78.99457550048828, perp. :137.0924072265625
2022-11-08 03:18:36,673 - INFO - test f1:   F1:45.88% Co F1: 49.63%, Disco F1:  5.55%, Co P: 37.30%, Co R:74.17%,  Disco P: 3.57%, Disco R:12.48%,   Cont TP: 21434.0, Cont FP: 36036.0, Cont FN: 7464.0, Disco TP: 223.0, Disco FP: 6025.0, Disco FN: 1564.0
2022-11-08 03:18:36,673 - INFO - test ll:   avg likelihood: -80.65544891357422, perp. :135.11341857910156
2022-11-08 03:18:36,673 - INFO - 0:13:36.476607s elapsed

2022-11-08 03:31:02,504 - INFO - Epoch 16 / 30:
2022-11-08 03:31:14,456 - INFO - dev f1:   F1:46.88% Co F1: 50.70%, Disco F1:  7.36%, Co P: 37.72%, Co R:77.29%,  Disco P: 4.95%, Disco R:14.39%,   Cont TP: 4061.0, Cont FP: 6705.0, Cont FN: 1193.0, Disco TP: 57.0, Disco FP: 1095.0, Disco FN: 339.0
2022-11-08 03:31:14,456 - INFO - dev ll:   avg likelihood: -79.4185562133789, perp. :140.76133728027344
2022-11-08 03:32:13,894 - INFO - test f1:   F1:45.74% Co F1: 49.40%, Disco F1:  5.63%, Co P: 37.09%, Co R:73.93%,  Disco P: 3.64%, Disco R:12.42%,   Cont TP: 21369.0, Cont FP: 36243.0, Cont FN: 7535.0, Disco TP: 222.0, Disco FP: 5884.0, Disco FN: 1565.0
2022-11-08 03:32:13,895 - INFO - test ll:   avg likelihood: -81.14164733886719, perp. :139.1690673828125
2022-11-08 03:32:13,895 - INFO - 0:13:35.936157s elapsed

2022-11-08 03:44:41,524 - INFO - Epoch 17 / 30:
2022-11-08 03:44:53,557 - INFO - dev f1:   F1:46.58% Co F1: 50.33%, Disco F1:  7.43%, Co P: 37.43%, Co R:76.80%,  Disco P: 5.01%, Disco R:14.39%,   Cont TP: 4035.0, Cont FP: 6745.0, Cont FN: 1219.0, Disco TP: 57.0, Disco FP: 1081.0, Disco FN: 339.0
2022-11-08 03:44:53,557 - INFO - dev ll:   avg likelihood: -79.10946655273438, perp. :138.07701110839844
2022-11-08 03:45:53,116 - INFO - test f1:   F1:45.64% Co F1: 49.23%, Disco F1:  5.88%, Co P: 36.95%, Co R:73.73%,  Disco P: 3.81%, Disco R:12.87%,   Cont TP: 21313.0, Cont FP: 36364.0, Cont FN: 7593.0, Disco TP: 230.0, Disco FP: 5811.0, Disco FN: 1557.0
2022-11-08 03:45:53,116 - INFO - test ll:   avg likelihood: -80.8956298828125, perp. :137.10189819335938
2022-11-08 03:45:53,117 - INFO - 0:13:37.948539s elapsed

2022-11-08 03:58:20,434 - INFO - Epoch 18 / 30:
2022-11-08 03:58:32,442 - INFO - dev f1:   F1:44.19% Co F1: 47.85%, Disco F1:  6.67%, Co P: 35.61%, Co R:72.90%,  Disco P: 4.47%, Disco R:13.13%,   Cont TP: 3830.0, Cont FP: 6925.0, Cont FN: 1424.0, Disco TP: 52.0, Disco FP: 1111.0, Disco FN: 344.0
2022-11-08 03:58:32,442 - INFO - dev ll:   avg likelihood: -83.0733871459961, perp. :176.74868774414062
2022-11-08 03:59:31,960 - INFO - test f1:   F1:43.53% Co F1: 46.98%, Disco F1:  5.74%, Co P: 35.27%, Co R:70.34%,  Disco P: 3.71%, Disco R:12.65%,   Cont TP: 20322.0, Cont FP: 37303.0, Cont FN: 8571.0, Disco TP: 226.0, Disco FP: 5867.0, Disco FN: 1561.0
2022-11-08 03:59:31,961 - INFO - test ll:   avg likelihood: -84.27667236328125, perp. :168.40750122070312
2022-11-08 03:59:31,961 - INFO - 0:13:37.507065s elapsed

2022-11-08 04:11:59,565 - INFO - Epoch 19 / 30:
2022-11-08 04:12:11,596 - INFO - dev f1:   F1:46.63% Co F1: 50.42%, Disco F1:  7.15%, Co P: 37.50%, Co R:76.91%,  Disco P: 4.82%, Disco R:13.89%,   Cont TP: 4041.0, Cont FP: 6735.0, Cont FN: 1213.0, Disco TP: 55.0, Disco FP: 1087.0, Disco FN: 341.0
2022-11-08 04:12:11,596 - INFO - dev ll:   avg likelihood: -80.16161346435547, perp. :147.4296417236328
2022-11-08 04:13:11,218 - INFO - test f1:   F1:45.59% Co F1: 49.21%, Disco F1:  5.77%, Co P: 36.94%, Co R:73.68%,  Disco P: 3.73%, Disco R:12.70%,   Cont TP: 21291.0, Cont FP: 36343.0, Cont FN: 7604.0, Disco TP: 227.0, Disco FP: 5857.0, Disco FN: 1560.0
2022-11-08 04:13:11,218 - INFO - test ll:   avg likelihood: -81.62995910644531, perp. :143.36476135253906
2022-11-08 04:13:11,218 - INFO - 0:13:37.990652s elapsed

2022-11-08 04:25:39,378 - INFO - Epoch 20 / 30:
2022-11-08 04:25:51,410 - INFO - dev f1:   F1:45.99% Co F1: 49.75%, Disco F1:  6.99%, Co P: 37.01%, Co R:75.87%,  Disco P: 4.70%, Disco R:13.64%,   Cont TP: 3986.0, Cont FP: 6783.0, Cont FN: 1268.0, Disco TP: 54.0, Disco FP: 1095.0, Disco FN: 342.0
2022-11-08 04:25:51,411 - INFO - dev ll:   avg likelihood: -80.11668395996094, perp. :147.0177001953125
2022-11-08 04:26:51,080 - INFO - test f1:   F1:45.16% Co F1: 48.73%, Disco F1:  5.87%, Co P: 36.58%, Co R:72.98%,  Disco P: 3.80%, Disco R:12.93%,   Cont TP: 21081.0, Cont FP: 36552.0, Cont FN: 7806.0, Disco TP: 231.0, Disco FP: 5854.0, Disco FN: 1556.0
2022-11-08 04:26:51,080 - INFO - test ll:   avg likelihood: -81.61743927001953, perp. :143.25563049316406
2022-11-08 04:26:51,081 - INFO - 0:13:38.172801s elapsed

2022-11-08 04:39:19,204 - INFO - Epoch 21 / 30:
2022-11-08 04:39:31,208 - INFO - dev f1:   F1:46.06% Co F1: 49.87%, Disco F1:  6.93%, Co P: 37.12%, Co R:75.98%,  Disco P: 4.64%, Disco R:13.64%,   Cont TP: 3992.0, Cont FP: 6763.0, Cont FN: 1262.0, Disco TP: 54.0, Disco FP: 1109.0, Disco FN: 342.0
2022-11-08 04:39:31,209 - INFO - dev ll:   avg likelihood: -80.18283081054688, perp. :147.6246337890625
2022-11-08 04:40:30,912 - INFO - test f1:   F1:45.27% Co F1: 48.90%, Disco F1:  5.71%, Co P: 36.72%, Co R:73.16%,  Disco P: 3.69%, Disco R:12.70%,   Cont TP: 21138.0, Cont FP: 36421.0, Cont FN: 7756.0, Disco TP: 227.0, Disco FP: 5932.0, Disco FN: 1560.0
2022-11-08 04:40:30,913 - INFO - test ll:   avg likelihood: -81.66593170166016, perp. :143.67881774902344
2022-11-08 04:40:30,913 - INFO - 0:13:38.533728s elapsed

2022-11-08 04:53:01,835 - INFO - Epoch 22 / 30:
2022-11-08 04:53:13,881 - INFO - dev f1:   F1:46.49% Co F1: 50.21%, Disco F1:  7.58%, Co P: 37.34%, Co R:76.63%,  Disco P: 5.11%, Disco R:14.65%,   Cont TP: 4026.0, Cont FP: 6757.0, Cont FN: 1228.0, Disco TP: 58.0, Disco FP: 1077.0, Disco FN: 338.0
2022-11-08 04:53:13,881 - INFO - dev ll:   avg likelihood: -80.19235229492188, perp. :147.71229553222656
2022-11-08 04:54:13,499 - INFO - test f1:   F1:45.20% Co F1: 48.77%, Disco F1:  5.68%, Co P: 36.59%, Co R:73.08%,  Disco P: 3.68%, Disco R:12.42%,   Cont TP: 21109.0, Cont FP: 36574.0, Cont FN: 7777.0, Disco TP: 222.0, Disco FP: 5813.0, Disco FN: 1565.0
2022-11-08 04:54:13,499 - INFO - test ll:   avg likelihood: -81.70039367675781, perp. :143.9803009033203
2022-11-08 04:54:13,807 - INFO - 0:13:41.311287s elapsed, Best saved

2022-11-08 05:06:42,945 - INFO - Epoch 23 / 30:
2022-11-08 05:06:54,980 - INFO - dev f1:   F1:46.06% Co F1: 49.74%, Disco F1:  7.46%, Co P: 36.99%, Co R:75.92%,  Disco P: 5.03%, Disco R:14.39%,   Cont TP: 3989.0, Cont FP: 6796.0, Cont FN: 1265.0, Disco TP: 57.0, Disco FP: 1076.0, Disco FN: 339.0
2022-11-08 05:06:54,981 - INFO - dev ll:   avg likelihood: -80.62327575683594, perp. :151.7309112548828
2022-11-08 05:07:54,655 - INFO - test f1:   F1:44.99% Co F1: 48.55%, Disco F1:  5.70%, Co P: 36.43%, Co R:72.74%,  Disco P: 3.69%, Disco R:12.48%,   Cont TP: 21012.0, Cont FP: 36667.0, Cont FN: 7873.0, Disco TP: 223.0, Disco FP: 5816.0, Disco FN: 1564.0
2022-11-08 05:07:54,655 - INFO - test ll:   avg likelihood: -82.0127944946289, perp. :146.7425079345703
2022-11-08 05:07:54,655 - INFO - 0:13:39.543993s elapsed

2022-11-08 05:20:22,577 - INFO - Epoch 24 / 30:
2022-11-08 05:20:34,581 - INFO - dev f1:   F1:46.21% Co F1: 49.91%, Disco F1:  7.56%, Co P: 37.12%, Co R:76.15%,  Disco P: 5.09%, Disco R:14.65%,   Cont TP: 4001.0, Cont FP: 6778.0, Cont FN: 1253.0, Disco TP: 58.0, Disco FP: 1081.0, Disco FN: 338.0
2022-11-08 05:20:34,581 - INFO - dev ll:   avg likelihood: -80.4783706665039, perp. :150.36752319335938
2022-11-08 05:21:34,281 - INFO - test f1:   F1:45.53% Co F1: 49.18%, Disco F1:  5.64%, Co P: 36.92%, Co R:73.62%,  Disco P: 3.64%, Disco R:12.48%,   Cont TP: 21264.0, Cont FP: 36328.0, Cont FN: 7619.0, Disco TP: 223.0, Disco FP: 5903.0, Disco FN: 1564.0
2022-11-08 05:21:34,282 - INFO - test ll:   avg likelihood: -81.84700775146484, perp. :145.2700958251953
2022-11-08 05:21:34,282 - INFO - 0:13:38.348432s elapsed

2022-11-08 05:34:04,448 - INFO - Epoch 25 / 30:
2022-11-08 05:34:16,514 - INFO - dev f1:   F1:44.81% Co F1: 48.53%, Disco F1:  6.21%, Co P: 36.11%, Co R:74.00%,  Disco P: 4.17%, Disco R:12.12%,   Cont TP: 3888.0, Cont FP: 6880.0, Cont FN: 1366.0, Disco TP: 48.0, Disco FP: 1102.0, Disco FN: 348.0
2022-11-08 05:34:16,514 - INFO - dev ll:   avg likelihood: -83.27333068847656, perp. :178.96377563476562
2022-11-08 05:35:16,693 - INFO - test f1:   F1:44.12% Co F1: 47.72%, Disco F1:  4.71%, Co P: 35.82%, Co R:71.43%,  Disco P: 3.04%, Disco R:10.41%,   Cont TP: 20636.0, Cont FP: 36971.0, Cont FN: 8252.0, Disco TP: 186.0, Disco FP: 5925.0, Disco FN: 1601.0
2022-11-08 05:35:16,693 - INFO - test ll:   avg likelihood: -84.63093566894531, perp. :172.07586669921875
2022-11-08 05:35:16,693 - INFO - 0:13:41.158397s elapsed

2022-11-08 05:47:47,652 - INFO - Epoch 26 / 30:
2022-11-08 05:47:59,696 - INFO - dev f1:   F1:44.98% Co F1: 49.01%, Disco F1:  5.42%, Co P: 36.55%, Co R:74.36%,  Disco P: 3.58%, Disco R:11.11%,   Cont TP: 3907.0, Cont FP: 6782.0, Cont FN: 1347.0, Disco TP: 44.0, Disco FP: 1185.0, Disco FN: 352.0
2022-11-08 05:47:59,697 - INFO - dev ll:   avg likelihood: -83.74202728271484, perp. :184.2657928466797
2022-11-08 05:48:59,495 - INFO - test f1:   F1:43.71% Co F1: 47.42%, Disco F1:  4.75%, Co P: 35.67%, Co R:70.73%,  Disco P: 3.03%, Disco R:10.91%,   Cont TP: 20437.0, Cont FP: 36855.0, Cont FN: 8458.0, Disco TP: 195.0, Disco FP: 6231.0, Disco FN: 1592.0
2022-11-08 05:48:59,496 - INFO - test ll:   avg likelihood: -84.88883209228516, perp. :174.79666137695312
2022-11-08 05:48:59,496 - INFO - 0:13:41.572430s elapsed

2022-11-08 06:01:30,290 - INFO - Epoch 27 / 30:
2022-11-08 06:01:42,389 - INFO - dev f1:   F1:46.52% Co F1: 50.35%, Disco F1:  7.61%, Co P: 37.49%, Co R:76.63%,  Disco P: 5.08%, Disco R:15.15%,   Cont TP: 4026.0, Cont FP: 6712.0, Cont FN: 1228.0, Disco TP: 60.0, Disco FP: 1120.0, Disco FN: 336.0
2022-11-08 06:01:42,390 - INFO - dev ll:   avg likelihood: -81.57643127441406, perp. :161.01248168945312
2022-11-08 06:02:42,182 - INFO - test f1:   F1:45.61% Co F1: 49.33%, Disco F1:  5.59%, Co P: 37.06%, Co R:73.74%,  Disco P: 3.59%, Disco R:12.53%,   Cont TP: 21305.0, Cont FP: 36182.0, Cont FN: 7586.0, Disco TP: 224.0, Disco FP: 6007.0, Disco FN: 1563.0
2022-11-08 06:02:42,182 - INFO - test ll:   avg likelihood: -83.05033111572266, perp. :156.30210876464844
2022-11-08 06:02:42,380 - INFO - 0:13:41.422777s elapsed, Best saved

2022-11-08 06:15:11,326 - INFO - Epoch 28 / 30:
2022-11-08 06:15:23,382 - INFO - dev f1:   F1:47.14% Co F1: 51.00%, Disco F1:  7.34%, Co P: 37.95%, Co R:77.73%,  Disco P: 4.93%, Disco R:14.39%,   Cont TP: 4084.0, Cont FP: 6677.0, Cont FN: 1170.0, Disco TP: 57.0, Disco FP: 1100.0, Disco FN: 339.0
2022-11-08 06:15:23,382 - INFO - dev ll:   avg likelihood: -80.92168426513672, perp. :154.57765197753906
2022-11-08 06:16:23,190 - INFO - test f1:   F1:46.31% Co F1: 50.06%, Disco F1:  5.65%, Co P: 37.60%, Co R:74.86%,  Disco P: 3.64%, Disco R:12.59%,   Cont TP: 21632.0, Cont FP: 35904.0, Cont FN: 7264.0, Disco TP: 225.0, Disco FP: 5957.0, Disco FN: 1562.0
2022-11-08 06:16:23,190 - INFO - test ll:   avg likelihood: -82.23167419433594, perp. :148.70933532714844
2022-11-08 06:16:23,190 - INFO - 0:13:39.528695s elapsed

2022-11-08 06:28:52,088 - INFO - Epoch 29 / 30:
2022-11-08 06:29:04,118 - INFO - dev f1:   F1:47.35% Co F1: 51.24%, Disco F1:  7.33%, Co P: 38.13%, Co R:78.07%,  Disco P: 4.91%, Disco R:14.39%,   Cont TP: 4102.0, Cont FP: 6656.0, Cont FN: 1152.0, Disco TP: 57.0, Disco FP: 1103.0, Disco FN: 339.0
2022-11-08 06:29:04,118 - INFO - dev ll:   avg likelihood: -81.13652038574219, perp. :156.66026306152344
2022-11-08 06:30:03,881 - INFO - test f1:   F1:46.43% Co F1: 50.20%, Disco F1:  5.66%, Co P: 37.71%, Co R:75.07%,  Disco P: 3.65%, Disco R:12.65%,   Cont TP: 21691.0, Cont FP: 35829.0, Cont FN: 7204.0, Disco TP: 226.0, Disco FP: 5972.0, Disco FN: 1561.0
2022-11-08 06:30:03,881 - INFO - test ll:   avg likelihood: -82.61790466308594, perp. :152.24444580078125
2022-11-08 06:30:03,881 - INFO - 0:13:39.424559s elapsed

2022-11-08 06:42:32,823 - INFO - Epoch 30 / 30:
2022-11-08 06:42:44,890 - INFO - dev f1:   F1:47.44% Co F1: 51.32%, Disco F1:  7.24%, Co P: 38.18%, Co R:78.25%,  Disco P: 4.87%, Disco R:14.14%,   Cont TP: 4111.0, Cont FP: 6656.0, Cont FN: 1143.0, Disco TP: 56.0, Disco FP: 1095.0, Disco FN: 340.0
2022-11-08 06:42:44,890 - INFO - dev ll:   avg likelihood: -80.6256332397461, perp. :151.75326538085938
2022-11-08 06:43:44,665 - INFO - test f1:   F1:46.52% Co F1: 50.24%, Disco F1:  5.54%, Co P: 37.71%, Co R:75.25%,  Disco P: 3.58%, Disco R:12.20%,   Cont TP: 21735.0, Cont FP: 35902.0, Cont FN: 7147.0, Disco TP: 218.0, Disco FP: 5863.0, Disco FN: 1569.0
2022-11-08 06:43:44,666 - INFO - test ll:   avg likelihood: -82.09008026123047, perp. :147.43399047851562
2022-11-08 06:43:44,666 - INFO - 0:13:39.091571s elapsed

